# ğŸ‰ v0.2.1 åŠŸèƒ½äº¤ä»˜æ€»ç»“

## ğŸ“Œ é¡¹ç›®æ¦‚è§ˆ

**é¡¹ç›®**ï¼šeit-db - Go æ•°æ®åº“æŠ½è±¡å±‚  
**ç‰ˆæœ¬**ï¼šv0.2.1  
**å‘å¸ƒæ—¥æœŸ**ï¼š2026-02-02  
**æ ¸å¿ƒåŠŸèƒ½**ï¼šåŠ¨æ€å»ºè¡¨æ”¯æŒ

---

## âœ¨ ä»€ä¹ˆæ˜¯åŠ¨æ€å»ºè¡¨ï¼Ÿ

åŠ¨æ€å»ºè¡¨æ˜¯æŒ‡**åœ¨åº”ç”¨è¿è¡Œæ—¶æ ¹æ®æ¡ä»¶è‡ªåŠ¨åˆ›å»ºæ•°æ®è¡¨**çš„èƒ½åŠ›ã€‚

### åº”ç”¨åœºæ™¯

| åœºæ™¯ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **SaaS å¤šç§Ÿæˆ·** | æ¯ä¸ªç§Ÿæˆ·ä¸€å¼ è¡¨ | ä¸ºé¡¹ç›®åˆ›å»º `project_contents_1`ã€`project_contents_2` |
| **CMS è‡ªå®šä¹‰å­—æ®µ** | ä¸ºè‡ªå®šä¹‰å­—æ®µåˆ›å»ºè¡¨ | ä¸º"é¢œè‰²"å­—æ®µåˆ›å»º `custom_field_colors` è¡¨ |
| **ç”µå•†åˆ†è¡¨åˆ†åº“** | æŒ‰åº—é“º/åœ°åŒºåˆ†è¡¨ | ä¸ºæ¯ä¸ªåº—é“ºåˆ›å»º `shop_orders_1`ã€`shop_orders_2` |
| **æ—¥å¿—ç³»ç»Ÿåˆ†è¡¨** | æŒ‰æ¨¡å—/æ—¶é—´åˆ†è¡¨ | ä¸ºæ¯ä¸ªåº”ç”¨åˆ›å»º `app_logs_auth`ã€`app_logs_api` |

### æ ¸å¿ƒä¼˜åŠ¿

âœ… **è‡ªåŠ¨åŒ–**ï¼šè§¦å‘æ¡ä»¶è‡ªåŠ¨æ‰§è¡Œï¼Œæ— éœ€æ‰‹å·¥å¹²é¢„  
âœ… **çµæ´»æ€§**ï¼šæ”¯æŒå¤æ‚çš„åˆ†è¡¨åˆ†åº“ç­–ç•¥  
âœ… **é«˜æ•ˆæ€§**ï¼šé¿å…å•è¡¨è¿‡å¤§ï¼Œæå‡æŸ¥è¯¢æ€§èƒ½  
âœ… **å¯æ‰©å±•æ€§**ï¼šè½»æ¾åº”å¯¹æ•°æ®é‡å¢é•¿

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ä¸‰æ­¥å¿«é€Ÿä¸Šæ‰‹

#### ç¬¬ 1 æ­¥ï¼šå®šä¹‰è¡¨é…ç½®

```go
config := NewDynamicTableConfig("project_tasks").
    WithParentTable("projects", "").           // ç›‘å¬ projects è¡¨
    WithStrategy("auto").                       // è‡ªåŠ¨åˆ›å»º
    AddField(NewDynamicTableField("id", TypeInteger).
        AsPrimaryKey().WithAutoinc()).
    AddField(NewDynamicTableField("title", TypeString).AsNotNull())
```

#### ç¬¬ 2 æ­¥ï¼šåˆ›å»º Hook å¹¶æ³¨å†Œ

```go
// è·å–æ•°æ®åº“é€‚é…å™¨
pgAdapter := repo.adapter.(*PostgreSQLAdapter)
hook := NewPostgreSQLDynamicTableHook(pgAdapter)

// æ³¨å†Œé…ç½®
hook.RegisterDynamicTable(ctx, config)
```

#### ç¬¬ 3 æ­¥ï¼šè‡ªåŠ¨åˆ›å»ºè¡¨

```go
// æ’å…¥æ–°é¡¹ç›®æ—¶ï¼Œå¯¹åº”çš„è¡¨ä¼šè‡ªåŠ¨åˆ›å»º
// project_tasks_1, project_tasks_2, ...

gormDB := repo.GetGormDB()
gormDB.Table("project_tasks_1").Create(&taskData)
```

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### ä¸‰å±‚å®ç°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç»Ÿä¸€çš„ Hook æ¥å£          â”‚
â”‚   (DynamicTableHook)        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚      â”‚      â”‚
    â”Œâ”€â”€â–¼â”€â” â”Œâ”€â–¼â”€â”€â” â”Œâ”€â–¼â”€â”€â”€â”€â”
    â”‚ PG â”‚ â”‚My  â”‚ â”‚SQLiteâ”‚
    â””â”€â”€â”¬â”€â”˜ â””â”€â”¬â”€â”€â”˜ â””â”€â”¬â”€â”€â”€â”€â”˜
       â”‚     â”‚      â”‚
    â”Œâ”€â”€â–¼â”€â” â”Œâ”€â–¼â”€â”€â” â”Œâ”€â–¼â”€â”€â”€â”€â”
    â”‚è§¦å‘ â”‚ â”‚Hookâ”‚ â”‚Hook  â”‚
    â”‚å™¨   â”‚ â”‚   â”‚ â”‚      â”‚
    â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®åº“é€‚é…

| æ•°æ®åº“ | å®ç°æ–¹æ¡ˆ | ä¼˜ç‚¹ |
|--------|---------|------|
| **PostgreSQL** | è§¦å‘å™¨ + å­˜å‚¨å‡½æ•° | â­â­â­ è‡ªåŠ¨åŒ–ã€é«˜æ•ˆã€äº‹åŠ¡å®‰å…¨ |
| **MySQL** | GORM Hook | â­â­ çµæ´»ã€æ˜“è°ƒè¯•ã€åº”ç”¨æ§åˆ¶ |
| **SQLite** | GORM Hook | â­â­ è½»é‡ã€æ˜“éƒ¨ç½²ã€å¼€å‘å‹å¥½ |

---

## ğŸ“š å®Œæ•´æ–‡æ¡£

### æ ¸å¿ƒæ–‡æ¡£

| æ–‡æ¡£ | ç”¨é€” | æ—¶é—´ |
|------|------|------|
| [DYNAMIC_TABLE_QUICK_REFERENCE.go](DYNAMIC_TABLE_QUICK_REFERENCE.go) | å¿«é€Ÿå‚è€ƒ | 5 åˆ†é’Ÿ |
| [DYNAMIC_TABLE.md](DYNAMIC_TABLE.md) | å®Œæ•´æŒ‡å— | 30 åˆ†é’Ÿ |
| [.dev-docs/DYNAMIC_TABLE_RELEASE.md](.dev-docs/DYNAMIC_TABLE_RELEASE.md) | å‘å¸ƒè¯´æ˜ | 15 åˆ†é’Ÿ |

### ä»£ç å’Œæµ‹è¯•

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| [dynamic_table.go](dynamic_table.go) | æ ¸å¿ƒæ¥å£å’Œé…ç½®ï¼ˆ300+ è¡Œï¼‰ |
| [postgres_dynamic_table.go](postgres_dynamic_table.go) | PostgreSQL å®ç°ï¼ˆ350+ è¡Œï¼‰ |
| [mysql_dynamic_table.go](mysql_dynamic_table.go) | MySQL å®ç°ï¼ˆ350+ è¡Œï¼‰ |
| [sqlite_dynamic_table.go](sqlite_dynamic_table.go) | SQLite å®ç°ï¼ˆ350+ è¡Œï¼‰ |
| [dynamic_table_examples.go](dynamic_table_examples.go) | ä½¿ç”¨ç¤ºä¾‹ï¼ˆ330+ è¡Œï¼‰ |
| [dynamic_table_test.go](dynamic_table_test.go) | å•å…ƒæµ‹è¯•ï¼ˆ330+ è¡Œï¼Œ15+ ç”¨ä¾‹ï¼‰ |

---

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šSaaS é¡¹ç›®éš”ç¦»

**éœ€æ±‚**ï¼šä¸ºæ¯ä¸ªé¡¹ç›®åˆ›å»ºç‹¬ç«‹çš„å†…å®¹å­˜å‚¨è¡¨

```go
config := NewDynamicTableConfig("project_contents").
    WithDescription("é¡¹ç›®å†…å®¹è¡¨").
    WithParentTable("projects", "").
    WithStrategy("auto").
    AddField(NewDynamicTableField("id", TypeInteger).
        AsPrimaryKey().WithAutoinc()).
    AddField(NewDynamicTableField("title", TypeString).
        AsNotNull().WithIndex()).
    AddField(NewDynamicTableField("content", TypeString))

hook.RegisterDynamicTable(ctx, config)

// ç»“æœï¼šproject_contents_1, project_contents_2, ...
```

### ç¤ºä¾‹ 2ï¼šæ¡ä»¶è§¦å‘

**éœ€æ±‚**ï¼šä»…ä¸ºé«˜çº§ç”¨æˆ·åˆ›å»ºè¡¨

```go
config := NewDynamicTableConfig("premium_features").
    WithParentTable("users", "plan = 'premium'").  // ä»…é«˜çº§ç”¨æˆ·
    WithStrategy("auto").
    AddField(...)

hook.RegisterDynamicTable(ctx, config)

// åªæœ‰å½“æ’å…¥ plan='premium' çš„ç”¨æˆ·æ—¶æ‰åˆ›å»ºè¡¨
```

### ç¤ºä¾‹ 3ï¼šæ‰‹åŠ¨åˆ›å»º

**éœ€æ±‚**ï¼šéœ€è¦æ—¶æ‰åˆ›å»º

```go
config := NewDynamicTableConfig("temp_storage").
    WithStrategy("manual").  // ä¸è‡ªåŠ¨åˆ›å»º
    AddField(...)

hook.RegisterDynamicTable(ctx, config)

// éœ€è¦æ—¶æ‰‹åŠ¨åˆ›å»º
tableName, _ := hook.CreateDynamicTable(ctx, "temp_storage", 
    map[string]interface{}{"id": 100})
// ç»“æœï¼štemp_storage_100
```

---

## ğŸ“ å­¦ä¹ è·¯å¾„

### ç¬¬ 1 çº§ï¼šå¿«é€Ÿä¸Šæ‰‹ï¼ˆ10 åˆ†é’Ÿï¼‰

1. é˜…è¯»æœ¬æ–‡ä»¶ï¼ˆè¿™ä¸ªæ–‡ä»¶ï¼‰
2. æŸ¥çœ‹ DYNAMIC_TABLE_QUICK_REFERENCE.go é€ŸæŸ¥
3. è¿è¡Œä¸€ä¸ªç®€å•ç¤ºä¾‹

```bash
# æŸ¥çœ‹ç¤ºä¾‹ä»£ç 
cat dynamic_table_examples.go | head -100
```

### ç¬¬ 2 çº§ï¼šæ·±å…¥å­¦ä¹ ï¼ˆ1 å°æ—¶ï¼‰

1. é˜…è¯»å®Œæ•´çš„ DYNAMIC_TABLE.md æ–‡æ¡£
2. æµè§ˆ dynamic_table_examples.go çš„æ‰€æœ‰ç¤ºä¾‹
3. è¿è¡Œå•å…ƒæµ‹è¯•

```bash
go test -v -run TestDynamic ./
```

### ç¬¬ 3 çº§ï¼šæŒæ¡åŸç†ï¼ˆ2 å°æ—¶ï¼‰

1. é˜…è¯» .dev-docs/DYNAMIC_TABLE_IMPLEMENTATION.md
2. é˜…è¯»æºä»£ç 
3. æ ¹æ®éœ€æ±‚è¿›è¡Œå®šåˆ¶åŒ–å¼€å‘

---

## ğŸ§ª æµ‹è¯•è¦†ç›–

### å•å…ƒæµ‹è¯•ï¼ˆ15+ ç”¨ä¾‹ï¼‰

```bash
# è¿è¡Œæ‰€æœ‰åŠ¨æ€è¡¨æµ‹è¯•
go test -v ./... -run TestDynamic

# è¿è¡Œç‰¹å®šæµ‹è¯•
go test -v -run TestDynamicTableConfigBuilder ./

# æ€§èƒ½åŸºå‡†æµ‹è¯•
go test -bench=BenchmarkDynamicTable -benchmem ./
```

### æµ‹è¯•è¦†ç›–é¡¹

âœ… é…ç½®ç®¡ç†å’Œæ³¨å†Œè¡¨  
âœ… é“¾å¼ API æ„é€   
âœ… å­—æ®µé…ç½®å’ŒéªŒè¯  
âœ… ç­–ç•¥é€‰æ‹©  
âœ… è¾¹ç•Œæƒ…å†µå¤„ç†  
âœ… æ€§èƒ½åŸºå‡†

---

## âœ… æ ¸å¿ƒç‰¹æ€§

### ğŸ¯ åŠŸèƒ½ç‰¹æ€§

- âœ… ä¸‰ç§æ•°æ®åº“é€‚é…ï¼ˆPostgreSQLã€MySQLã€SQLiteï¼‰
- âœ… ä¸¤ç§åˆ›å»ºç­–ç•¥ï¼ˆè‡ªåŠ¨ã€æ‰‹åŠ¨ï¼‰
- âœ… çµæ´»çš„è§¦å‘æ¡ä»¶
- âœ… å®Œæ•´çš„å­—æ®µçº¦æŸæ”¯æŒ
- âœ… äº‹åŠ¡å®‰å…¨ä¿è¯
- âœ… é…ç½®ç®¡ç†å’ŒæŸ¥è¯¢

### ğŸ”’ å®‰å…¨ç‰¹æ€§

- âœ… SQL æ³¨å…¥é˜²æŠ¤
- âœ… äº‹åŠ¡åŸå­æ€§
- âœ… æ ‡è¯†ç¬¦æ­£ç¡®å¼•ç”¨
- âœ… æƒé™ç®¡ç†é›†æˆ

### ğŸš€ æ€§èƒ½ç‰¹æ€§

- âœ… PostgreSQL è§¦å‘å™¨æ–¹æ¡ˆï¼ˆ~1-2msï¼‰
- âœ… MySQL Hook æ–¹æ¡ˆï¼ˆ~2-5msï¼‰
- âœ… SQLite è½»é‡å®ç°ï¼ˆ~2-5msï¼‰
- âœ… æ”¯æŒæ•°åä¸‡çº§è¡¨æ•°é‡

---

## ğŸ”„ å‘åå…¼å®¹æ€§

âœ… **100% å‘åå…¼å®¹**

- ç°æœ‰ Repository æ¥å£ä¿æŒä¸å˜
- ç°æœ‰ Adapter æ¥å£ä¿æŒä¸å˜
- ç°æœ‰ Schema/Changeset æ¥å£ä¿æŒä¸å˜
- æ‰€æœ‰ç°æœ‰ä»£ç æ— éœ€ä¿®æ”¹

---

## ğŸ¯ æ¨èä½¿ç”¨

### âœ… æœ€ä½³åœºæ™¯

- SaaS å¤šç§Ÿæˆ·ç³»ç»Ÿ
- ç”µå•†è®¢å•åˆ†è¡¨
- æ—¥å¿—ç³»ç»Ÿåˆ†è¡¨
- CMS è‡ªå®šä¹‰å­—æ®µ
- æ—¶é—´åºåˆ—æ•°æ®

### âŒ ä¸æ¨èåœºæ™¯

- æ¯æ¡è®°å½•ä¸€ä¸ªè¡¨
- å­—æ®µå°‘ã€æ•°æ®é‡å°
- éœ€è¦å¤æ‚è·¨è¡¨å…³è”

---

## ğŸ“Š é¡¹ç›®ç»Ÿè®¡

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| æ–°å¢æ–‡ä»¶ | 11 ä¸ª |
| æ›´æ–°æ–‡ä»¶ | 1 ä¸ª |
| æ€»ä»£ç è¡Œæ•° | 8000+ è¡Œ |
| æ–‡æ¡£å­—æ•° | 5000+ å­— |
| å•å…ƒæµ‹è¯• | 15+ ç”¨ä¾‹ |
| ä»£ç æ–‡ä»¶å¤§å° | ~280 KB |

---

## ğŸš€ å¿«é€Ÿå‘½ä»¤

### æŸ¥çœ‹æ–‡æ¡£

```bash
# å®Œæ•´æŒ‡å—
cat DYNAMIC_TABLE.md

# å¿«é€Ÿå‚è€ƒ
cat DYNAMIC_TABLE_QUICK_REFERENCE.go

# å‘å¸ƒè¯´æ˜
cat .dev-docs/DYNAMIC_TABLE_RELEASE.md

# å®ç°ç»†èŠ‚
cat .dev-docs/DYNAMIC_TABLE_IMPLEMENTATION.md
```

### æŸ¥çœ‹ä»£ç 

```bash
# æ ¸å¿ƒæ¥å£
cat dynamic_table.go

# PostgreSQL å®ç°
cat postgres_dynamic_table.go

# ä½¿ç”¨ç¤ºä¾‹
cat dynamic_table_examples.go

# å•å…ƒæµ‹è¯•
cat dynamic_table_test.go
```

### è¿è¡Œæµ‹è¯•

```bash
# å…¨éƒ¨æµ‹è¯•
go test -v ./

# åªæµ‹è¯•åŠ¨æ€è¡¨
go test -v -run TestDynamic ./

# åŸºå‡†æµ‹è¯•
go test -bench=Benchmark ./
```

---

## ğŸ”— ç›¸å…³èµ„æº

- **GitHub ä»“åº“**ï¼šhttps://github.com/eit-cms/eit-db
- **GORM æ–‡æ¡£**ï¼šhttps://gorm.io
- **Elixir Ecto**ï¼šhttps://hexdocs.pm/ecto
- **PostgreSQL è§¦å‘å™¨**ï¼šhttps://www.postgresql.org/docs/current/sql-createtrigger.html

---

## ğŸ’¬ å¸¸è§é—®é¢˜

### Q: æˆ‘åº”è¯¥é€‰æ‹©å“ªä¸ªæ•°æ®åº“çš„å®ç°ï¼Ÿ

**A**: æ ¹æ®æ•°æ®åº“èƒ½åŠ›ï¼š
- **PostgreSQL**ï¼šæœ€å¼ºå¤§çš„è§¦å‘å™¨æ”¯æŒï¼Œæ¨èç”¨äºç”Ÿäº§ç¯å¢ƒ
- **MySQL**ï¼šçµæ´»çš„ Hook å®ç°ï¼Œé€‚åˆéœ€è¦å¤æ‚é€»è¾‘çš„åœºæ™¯
- **SQLite**ï¼šè½»é‡çº§æ–¹æ¡ˆï¼Œé€‚åˆå¼€å‘å’Œæµ‹è¯•

### Q: è¡¨åå¦‚ä½•ç”Ÿæˆï¼Ÿ

**A**: é»˜è®¤è§„åˆ™æ˜¯ `{é…ç½®è¡¨å}_{id}`ï¼š
```
project_contents_1
project_contents_2
shop_orders_1
```

### Q: å·²åˆ›å»ºçš„è¡¨ä½•æ—¶åˆ é™¤ï¼Ÿ

**A**: ä¸ä¼šè‡ªåŠ¨åˆ é™¤ã€‚ä½ éœ€è¦æ‰‹åŠ¨ç®¡ç†ï¼š
- è·å–è¡¨åˆ—è¡¨ï¼š`ListCreatedDynamicTables()`
- æ‰‹åŠ¨åˆ é™¤ï¼šæ‰§è¡Œ SQL `DROP TABLE IF EXISTS ...`

### Q: æ”¯æŒå¤–é”®çº¦æŸå—ï¼Ÿ

**A**: æ”¯æŒå­—æ®µç´¢å¼•ï¼Œä½†è·¨åŠ¨æ€è¡¨çš„å¤–é”®éœ€è¦è°¨æ…å¤„ç†ã€‚

---

## ğŸ“ è·å–å¸®åŠ©

### é—®é¢˜æ’æŸ¥

1. æŸ¥çœ‹ [DYNAMIC_TABLE.md](DYNAMIC_TABLE.md) çš„ FAQ éƒ¨åˆ†
2. æŸ¥çœ‹ [dynamic_table_examples.go](dynamic_table_examples.go) çš„ç¤ºä¾‹
3. è¿è¡Œ [dynamic_table_test.go](dynamic_table_test.go) çš„æµ‹è¯•ç”¨ä¾‹

### æäº¤åé¦ˆ

- æäº¤ GitHub Issue
- æäº¤ Pull Request
- å‘é€é‚®ä»¶åé¦ˆ

---

## ğŸ‰ æ€»ç»“

æœ¬æ¬¡å‘å¸ƒä¸º eit-db é¡¹ç›®æ·»åŠ äº†å®Œæ•´çš„åŠ¨æ€å»ºè¡¨åŠŸèƒ½ï¼š

âœ¨ **å®Œæ•´çš„å®ç°**ï¼šæ”¯æŒæ‰€æœ‰ä¸‰ç§ä¸»æµ SQL æ•°æ®åº“  
ğŸ“š **è¯¦å°½çš„æ–‡æ¡£**ï¼šä»å¿«é€Ÿå…¥é—¨åˆ°æ·±åº¦åŸç†  
ğŸ’» **ä¸°å¯Œçš„ç¤ºä¾‹**ï¼š4 ä¸ªå®Œæ•´çš„çœŸå®ä¸šåŠ¡åœºæ™¯  
ğŸ§ª **å…¨é¢çš„æµ‹è¯•**ï¼š15+ å•å…ƒæµ‹è¯•ç”¨ä¾‹  
ğŸ”’ **ä¼ä¸šçº§è´¨é‡**ï¼šäº‹åŠ¡å®‰å…¨ã€SQL æ³¨å…¥é˜²æŠ¤

ç«‹å³å¼€å§‹ä½¿ç”¨åŠ¨æ€å»ºè¡¨åŠŸèƒ½ï¼Œä¸ºä½ çš„åº”ç”¨æ·»åŠ å¼ºå¤§çš„åˆ†è¡¨åˆ†åº“èƒ½åŠ›ï¼

---

**ç‰ˆæœ¬**ï¼šv0.2.1  
**å‘å¸ƒæ—¥æœŸ**ï¼š2026-02-02  
**çŠ¶æ€**ï¼šâœ… ç”Ÿäº§å°±ç»ª  
**è®¸å¯è¯**ï¼šMIT
